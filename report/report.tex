\documentclass{report}
% pre\'ambulo

\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[spanish,activeacute]{babel}
\usepackage{mathtools}
\usepackage{graphicx}
\usepackage{url}

\title{
	{Modelo Matematico Depredador-Presa de Lotka-Volterra}\\
	{\large Instituto Tecnológico de Estudios Superiores de la Región Carbonífera}\\
	%{\includegraphics[scale=0.2]{graficos/logoUniversity.jpg}}
}
\author{Alejandro Méndez Pérez \and Rodolfo Saucedo}

\begin{document}
% cuerpo del documento

\maketitle
\newpage
\tableofcontents
%Seria mas como un prefacio esto no?%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter*{Introducción}
Se busca recrear el modelo matematico de Lotke-Volterra para aplicar los conocimientos adquiridos en Sistemas de Ecuaciones Diferenciales Lineales de Primer Orden, este documento explicara el modelo

\chapter*{Intr}
El calculo es la herramienta mas exacta con la que se cuenta para modelar el mundo que nos rodea, no predice exactamente el comportamiento de algun sistema pero se acerca con gran precision y exactitud al verdadero comportamiento. Existen diferentes tipos de sistemas para obtener un comportamiento como son los sistemas lineales son faciles de resolver analiticamente, y los sistemas no lineales estos son mas dificiles de resolver que incluso no existen matematicas para resolverlo, por esto es necesario aproximar su comportamiento convirtiendolo en un sistema lineal dentro de un determinado rango.

\chapter{Modelo Depredador-Presa}

el modelo lleva a la ecuacion 
\begin{align}
\frac{dx}{dt}= xa-bxy  \label{eq:EDOsnoLin}\\
\frac{dy}{dt}= cxy-dy
\end{align}

Se puede observar que es un sistema de ecuaciones diferenciales de primer orden no lineales.

Para solucionar este tipo de ecuaciones primeramente se tiene que linealizar el modelo basandonos en el punto de equilibrio, esto es cuando las derivadas son 0.

%\subsection*{Pero ¿Que sucede con el modelo al hacer esto?}
\subsection*{Efecto de linealizar el sistema}

La dos poblaciones de animales $x(t)$ y $y(t)$ que cohabitan el mismo ambiente y que
posiblemente compiten por la misma comida o presa de uno u otra.

 $x(t)$ podría representar el número de conejos y $y(t)$ el número de ardillas en el tiempo $t$. Así, el punto crítico del sistema $(x_w , y_w )$ especifica una población constante $x_w$ de conejos y una población constante de ardillas $y_w$ que pueden coexistir una con otra en el medio ambiente. Si $(x_0 , y_0 )$ no es un punto crítico del sistema, entonces no es posible para esa población constante de conejos $x_0$ y de ardillas $y_0$ que puedan coexistir, una o las dos deben cambiar con el tiempo.

\section{Linealizando modelo}
\subsection{Puntos criticos o de equilibrio}
Se tiene que el punto de equilibrio se encuentra cuando sus derivadas son 0 y por lo tanto encontrarlo indica que es una solucion $(x,y)$ al sistema de ecuaciones.

\begin{align}
0= xa-bxy \label{eq:equiEDO} \\
0= cxy-dy \label{eq:equiEDO2}
\end{align}

Podemos observar que ahora podemos obtener valores en $x$ e $y$ encontrando sus raices, por lo tanto la ecuacion \ref{eq:equiEDO} implica que
\begin{equation}
x(a-by)= 0
\begin{cases}
x=0\\
y=\frac{a}{b}
\end{cases}
\end{equation}
y que en \ref{eq:equiEDO2} son
\begin{equation}
y(cx-d)= 0
\begin{cases}
x=\frac{d}{c}\\
y=0
\end{cases}
\end{equation}

De esto se deduce que el sistema depredador-presa tiene dos puntos criticos en $(0,0)$ y  $(\frac{d}{c},\frac{a}{b})$.

Por lo tanto de este sistema \ref{eq:equiEDO} se interpretan dos funciones
\begin{align*}
f_1(x,y) = xa-bxy \\
f_2(x,y)= cxy-dy 
\end{align*}
de estas dos funciones es necesario obtiener la matriz jacobiana
que no es mas que las derivadas parciales con respecto a cada componentes en las funciones
\begin{align*}
J(x,y)=
\begin{bmatrix}
\frac{\partial f_1}{\partial x }& \frac{\partial f_1}{\partial y }\\
\frac{\partial f_2}{\partial x} &\frac{\partial f_2}{\partial y}
\end{bmatrix}
\end{align*} 
por lo tanto el sistema \ref{eq:equiEDO} tiene la matriz jacobiana
\begin{align}
J(x,y)&=
\left[
\begin{matrix}
a-by &-bx\\
cy &cx-d
\end{matrix}\right] \label{eq:mtrzJacob}
\end{align}
en la cual se aplicaran los puntos criticos obtenidos anteriormente.

\subsubsection{Punto critico en $(0,0)$}
Al aplicar el punto critico en \ref{eq:mtrzJacob} se obtiene
\begin{align}
J(0,0)&=
\left[
\begin{matrix}
a &0\\
0 &-d
\end{matrix}\right]
\end{align}
por lo tanto nuestro sistema linealizado quedaria de esta forma
\begin{align}
\frac{dx}{dt}&= ax \nonumber\\
\frac{dy}{dt}&= -dy \label{eq:sisPC1}
\end{align}

%Pero podemos comprobar que esta no es la solucion que esperamos al ver que $\lambda$ da a denotar que es un punto silla inestable.


\subsubsection{Punto critico en $(\frac{d}{c},\frac{a}{b})$}
Al igual partiendo de su matriz jacobiana \ref{eq:mtrzJacob}
y ahora aplicando el punto $(\frac{d}{c},\frac{a}{b})$ se tiene
\begin{align}
J(\frac{d}{c},\frac{a}{b})=
\left[
\begin{matrix}
0 &-\frac{bd}{c}\\
\frac{ac}{b} &0
\end{matrix}\right]
\end{align}
por el cual se obtiene el siguiente sistema
\begin{align}
\frac{dx}{dt}&= -\frac{bd}{c}y \label{eq:sisPC2} \\
\frac{dy}{dt}&= \frac{ac}{b}x \nonumber
\end{align}

\section{Sistema del punto critico en $(0,0)$}
El sistema \ref{eq:sisPC1} da una solución para $x(t)$ e $y(t)$ al aplicar Laplace la obtendremos.
\begin{align*}
\mathcal{L}\left\{\frac{dx}{dt} \right.&= \left. ax\right\} \\
\mathcal{L}\left\{ \frac{dy}{dt}\right.&= \left.-dy \right\}
\end{align*}
Nuestra solucion esta dada por $X(s)$
\begin{align}
sX(s)-X(0)&=aX(s) \nonumber\\
\left[s-a\right]X(s) &=X(0) \\
X(s)&= \frac{X(0)}{s-a} \label{eq:xsLap}
\end{align}
tambien por $Y(s)$
\begin{align}
sY(s)-Y(0)=-dY(s) \nonumber \\
\left[s+d\right]Y(s)=Y(0)\nonumber \\
Y(s)=\frac{Y(0)}{s+d}
 \label{eq:ysLap}
\end{align}
Los valores iniciales $X(0)$, $Y(0)$ seran reemplazados con $A$ y $B$.

De las transformadas $X(s)$ e $Y(s)$ aplicamos Laplace inversa para poder obtener las soluciones en funcion de $t$.

Para $x(t)$
\begin{align}
x(t)&=\mathcal{L}\{X(s)\} =\mathcal{L}\left\{ \frac{A}{s-a}
\right\}\nonumber\\
x(t)&=Ae^{at} \label{eq:xtAnPC1}
\end{align}
por lo tanto \ref{eq:xtAnPC1} es la funcion que define el comportamiento de las presas en cualquier tiempo.

Ahora para $y(t)$
\begin{align}
y(t)&=\mathcal{L}\{Y(s)\} =\mathcal{L}\left\{ \frac{B}{s+d}
\right\}\nonumber\\
y(t)&=Be^{-dt}
\end{align}

\section{Sistema del punto critico en $(\frac{d}{c},\frac{a}{b})$}
El sistema \ref{eq:sisPC2} se puede encontrar una solucion para $x(t)$ y $y(t)$ al aplicar Laplace 
\begin{align*}
\mathcal{L}\left\{ \frac{dx}{dt}\right.
&=\left. -\frac{bd}{c}y  \right\}
\\
\mathcal{L}\left\{ \frac{dy}{dt}\right.
&= \left.\frac{ac}{b}x  \right\}
\end{align*}

Y por lo tanto nuestra solucion estaria dada por
\begin{subequations}
\begin{align}
[sX(s)-X(0)]&=-\frac{bd}{c}Y(s) \nonumber \\
[X(s)-\frac{X(0)}{s}]&=-\frac{bd}{c}\frac{Y(s)}{s} \nonumber\\
X(s)+\frac{bd}{c}\frac{Y(s)}{s}&=\frac{X(0)}{s} \label{eq:lapXs} \\
[sY(s)-Y(0)]&=\frac{ac}{b}X(s) \nonumber \\
[Y(s)-\frac{Y(0)}{s}]&=\frac{ac}{b}\frac{X(s)}{s} \nonumber \\
-\frac{ac}{b}\frac{X(s)}{s}+Y(s)&=\frac{Y(0)}{s} \label{eq:lapYs}
\end{align}
\end{subequations}

Podemos observar que este sistema puede representarse en su forma de matriz y resolverse por algun metodo matricial.

\begin{equation}
\left[\begin{matrix}
1 &\frac{bd}{sc} \\
-\frac{ac}{sb} &1
\end{matrix}\right]
\left[\begin{array}{c}
X(s)\\
Y(s)
\end{array}\right]
=
\frac{1}{s}\left[\begin{array}{c}
A\\
B
\end{array}\right]\label{eq:sistemAnLaplace}
\end{equation}

Los valores iniciales los hemos sustituido por las letras $A$ y $B$ esto es para que sea mas legible.

Por lo tanto ya que tenemos el sistema matricial partimos resolviendo con el metodo de Cramer
\subsection{Obteniendo $x(t)$}
Se tiene \ref{eq:sistemAnLaplace} se aplicara el metodo y obtendremos
\begin{align*}
X(s) &= \frac{\begin{vmatrix}
\frac{A}{s} &\frac{bd}{sc} \\
\frac{B}{s} &1
\end{vmatrix}}{
\begin{vmatrix}
1 &\frac{bd}{sc} \\
-\frac{ac}{sb} &1
\end{vmatrix}}
\end{align*}
de donde se va a resolver y simplificar hasta su termino invertible por lo tanto
\begin{align}
X(s)&=
\frac{\frac{A}{s}-{\frac{bdB}{s^2c}}}{
1+\frac{abcd}{s^2bc}}
=
\frac{\frac{scA-bdB}{s^2c}}{
\frac{s^2bc+abcd}{s^2bc}}
=
\frac{s^2bc(scA-bdB)}{s^2c(s^2bc+abcd)}\nonumber
\\X(s)&=
\frac{sbc^2A-bcdB}{s^2bc+abcd} 
=\frac{sbc^2A-bcdB}{s^2+ad} 
\end{align}
Ya que se tiene la funcion de $X(s)$ y se puede aplicar la inversa de Laplace
\begin{align*}
x(t)=\mathcal{L}^{-1}\left\{X(s) \right\}
=\mathcal{L}^{-1}\left\{  \frac{sbc^2A-bcdB}{s^2+ad}   \right\}
\end{align*}
que por linealidad se tiene
\begin{align}
x(t)
&=bc^2A\mathcal{L}^{-1}\left\{  \frac{s}{s^2+ad} \right\}-bcdB\mathcal{L}^{-1}\left\{
\frac{1}{s^2+ad} \right\} \nonumber
\\x(t)&=bc^2A\cos(t\sqrt{ad})-\frac{bcdB}{\sqrt{ad}}\sin(t\sqrt{ad}) \label{eq:xtAn}
\end{align}
de donde \ref{eq:xtAn} es la funcion que determina el comportamiento en las presas en cualquier tiempo $t$.

\subsection{Obteniendo $y(t)$}
Ahora obtendremos $y(t)$ a partir del sistema matricial de \ref{eq:sistemAnLaplace} de donde podemos obtenerla usando el metodo de Cramer.
\begin{equation}
Y(s)=
\frac{
\begin{vmatrix}
1 &\frac{A}{s} \\
-\frac{ac}{sb} &\frac{B}{s}
\end{vmatrix}}{
\begin{vmatrix}
1 &\frac{bd}{sc}\\
-\frac{ac}{sb} &1
\end{vmatrix}}
\end{equation}
Ahora resolviendolo hasta su termino invertible se obtendria
\begin{align}
Y(s)&=\frac{\frac{B}{s}+\frac{acA}{s^2b}}{
1+\frac{abdc}{s^2bc}}
=
\frac{\frac{sbB-acA}{s^2b}}{
\frac{s^2bc+abcd}{s^2bc}}
\nonumber\\Y(s)&=
\frac{s^2bc(sdB-acA)}{s^2b(s^2bc+abcd)}
=
\frac{scdB-ac^2A}{s^2bc+abcd}
\nonumber\\Y(s)&=
\frac{scdB-ac^2A}{s^2+ad} \label{eq:YsLaplace}
\end{align}

Ahora podemos obtener $y(t)$ transformando a $Y(s)$ aplicando la inversa de laplace
\begin{align*}
y(t)&=\mathcal{L}^-1\left\{ Y(s) \right\}
\end{align*}
de donde sustituimos por el resultado de \ref{eq:YsLaplace} 
\begin{align*}
y(t)&=\mathcal{L}^-1\left\{ \frac{scdB-ac^2A}{s^2+ad} \right\}
\end{align*}
que por linealidad podemos hacer esto
\begin{align*}
y(t)&=cdB\mathcal{L}^-1\left\{ \frac{s}{s^2+ad} \right\}
-ac^2A\mathcal{L}^-1\left\{ \frac{1}{s^2+ad} \right\}
\end{align*}
y entonces procedemos a transformar
\begin{align}
y(t)&=cdB\cos(t\sqrt{ad})
-\frac{ac^2A}{\sqrt{ad}}\sin(t\sqrt{ad}) \label{eq:ytAn}
\end{align}
y esta seria la funcion que puede representar el comportamiento de las especies en cualquier tiempo.

\subsection{Soluciones del modelo}

Las funciones que describen nuestro modelo en el punto critico son
\begin{align*}
y(t)&=cdB\cos(t\sqrt{ad})
-\frac{ac^2A}{\sqrt{ad}}\sin(t\sqrt{ad}) \\
x(t)&=bc^2A\cos(t\sqrt{ad})-\frac{bcdB}{\sqrt{ad}}\sin(t\sqrt{ad})
\end{align*}

\chapter{Solucion Numerica del modelo}
Es necesario el concepto de Derivada.
El valor de la derivada de una función en un punto puede interpretarse geométricamente, ya que se corresponde con la pendiente de la recta tangente a la gráfica de la función en dicho punto. La recta tangente es a su vez la gráfica de la mejor aproximación lineal de la función alrededor de dicho punto.
Su forma estaría dada por:
\begin{equation}\label{eq:derivada}
f'(x)=\lim_{h\to{0}}\frac{f(x+h)-f(x)}{h}
\end{equation}
Al ser $h\to{0}$ serian pasos infinitos y por ende es la aproximación más exacta de la derivada en un punto. Pero en Métodos Numericos es imposible tener pasos infinitos, los cálculos también serian infinitos. Es necesario tener un número de pasos definidos, entre más pasos más exactitud tendría la derivada al ser más pequeños, pero ya no tendría la forma de una recta tangente, ahora seria la recta secante de dos puntos.

Los casos que se han presentado de los problemas se pueden resolver numéricamente, esto es con una aproximación. La exactitud de esta aproximación dependerá del método empleado y de la definición que le queramos dar. Trabajaremos con dos métodos numericos, y verificaremos como realizan su trabajo en diferentes casos de definición para compararlos.\\
Antes que nada se tiene que escoger un método con el que se va a trabajar para encontrar la solución de la ecuación \ref{eq:EDOsnoLin} del capítulo anterior.

Para cualquiera de los métodos que se usaran (Método de Euler y Método de Euler Mejorado) se tiene primeramente que para diferencias finitas es necesario:

\begin{itemize}
\item Discretizar el dominio.
\item Discretizar la función.
\item Aplicar algún algoritmo de solución.
\end{itemize}

Y en ecuaciones de primer orden es necesario cumplir con estas condiciones:
\begin{itemize}
\item Que $y'=f(x,y)$
\item Deifinir un intervalo para la solución, este no puede ser infinito para dar con todas las soluciones de una ecuación, los calculos tambien serian infinitos. Para esto es necesario discretizar el dominio.
\item Necesita condiciones iniciales, esto es para conocer desde donde se empezara a calcular.
\end{itemize}

\section{Solución Numerica con Diferencias finitas}
Como se trabajara con el Método de Euler y un derivado de este, Método de Euler Mejorado, se necesita entender que este método es el más simple para resolver un problema de valor inicial.
\begin{equation*}
PVI= \left\{ \begin{array}{lr}
\frac{dy}{dx} = f(x,y) \\
y(x_0)=y_0 \\
y(x_i) = ?
\end{array}\right.
\end{equation*}

Considere el problema de calcular la pendiente de una curva desconocida que comienza en un punto dado y satisface una cierta ecuación diferencial dada. Se puede pensar en la ecuación diferencial como una fórmula que nos permite calcular la pendiente de la recta tangente a la curva en cualquier punto de la curva, siempre que el punto se conozca.
La idea es que a pesar de que la curva es desconocida en principio, su punto de comienzo (al cual denotamos por $k_0$) es conocido. Entonces, de la ecuación diferencial se puede computar la pendiente de la curva en el punto $k_0$ y por lo tanto la recta tangente a la curva.
Ahora, dando un pequeño paso sobre dicha recta, podemos tomarnos un nuevo punto $k_1$ y suponer que dicho punto pertenece a la curva, entonces seguimos el mismo razonamiento aplicado anteriormente y volvemos a calcular la pendiente de la recta tangente a la curva en el punto $k_1$. Luego de varios pasos tendremos formada una curva poligonal $k_0 k_1 k_2 k_3...$ En general esta curva que obtenemos al aplicar el método no diverge lejos de la curva original, además el error entre ambas curvas se puede minimizar si se dan pasos muy pequeños al avanzar sobre la recta tangente a la curva y además el intervalo sobre el que trabajamos es finito (aunque las cosas son más complicadas para ecuaciones inestables).

Este metodo conciste en dividir los intervalos que van de $x_0$ hasta $x_f$ (los denotaremos como $a$ para $x_0$ y $b$ para $x_f$) en $N$ subintervalos de ancho $h$, o sea:
\begin{equation*}
h=\frac{b-a}{n}
\end{equation*}
Donde $h$ es llamado tambien el diferencial ($\Delta$).

Ahora que entendemos el funcionamiento del método, por la forma de la derivada en la ecuación \ref{eq:derivada} existen diferentes formas de calcular la derivada en un punto.

\begin{itemize}
\item Backward\\
Tomando el punto anterior del punto a analizar, osea $k-1$.
	\begin{equation}
		\label{eq:derBackward}
		y'\approx\frac{y_k-y_{k-1}}{h}
	\end{equation}
\item Central\\
Tomando el punto anterior a $k$ que es $k-1$ y el proximo $k+1$.
	\begin{equation}			   							\label{eq:derCentral}
		y' \approx \frac{y_{k+1}-y_{k-1}}{2h}
	\end{equation}
\item Forward\\
Tomando el punto mas proximo a $k$, siendo $k+1$
	\begin{equation}
		\label{eq:derForward}
		y'\approx \frac{y_{k+1}-y_k}{h}
	\end{equation}
\end{itemize}

Para encontrar un conjunto de soluciones aproximadas es necesario discretizar la ecuacion para trabajar con algún metodo.

\subsection{Metodo de Euler o Explicito}
Ya que se tiene entendido como funciona primeramente se tiene que reacomodar la ecuación para que se pueda trabajar con ella. 
%aqui puede ir una informacion del metodo de euler
%%
%%esta informacion es obtenida de wikipedia tratar de incluir el link
Para esto es usada la ecuación \ref{eq:EDOsnoLin} y se discretiza de esta forma utilizando la ecuación \ref{eq:derForward} Forward y la sustituimos en 

\begin{align*}
X'_k= aX_{k}-bX_{k}Y_{k}  \\
Y'_k= cX_{k}Y_k-dY_k
\end{align*}
que quedaria representado asi
\begin{align*}
\frac{X_{k+1}-X_k}{h} = aX_{k}-bX_{k}Y_{k}  \\
\frac{Y_{k+1}-Y_k}{h} = cX_{k}Y_k-dY_k
\end{align*}
despejando y acomodando terminos se obtiene
\begin{align*}
X_{k+1}=(\frac{1}{h}+a-bY_k)hX_k \\
Y_{k+1}=(\frac{1}{h}+cX_k-d)hY_k
\end{align*}

\end{document}